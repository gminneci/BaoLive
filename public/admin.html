<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="favicon.ico?v=2">
    <title>Admin Dashboard - Sefton Park Camping</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>üë®‚Äçüíº Admin Dashboard</h1>
            <p class="subtitle">Manage registrations and activities</p>
        </header>

        <nav>
            <a href="index.html" class="btn btn-info btn-small">‚Üê Back to Home</a>
        </nav>

        <div id="alert-container"></div>

        <!-- Tabs -->
        <div class="card">
            <nav class="admin-nav"
                style="display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid var(--light-cream); flex-wrap: wrap;">
                <button class="tab-button active" id="tab-families" data-tab="families">
                    üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Families
                </button>
                <button class="tab-button" id="tab-activities" data-tab="activities">
                    üéØ Activities
                </button>
                <button class="tab-button" id="tab-signups" data-tab="signups">
                    üìù All Signups
                </button>
                <button class="tab-button" id="tab-payments" data-tab="payments">
                    üí≥ Payments
                </button>
                <button class="tab-button" id="tab-backups" data-tab="backups">
                    üíæ Backups
                </button>
            </nav>
        </div>

        <!-- Tab: Family Registrations -->
        <div class="tab-content" id="content-families">
            <div class="card">
                <div class="flex-between mb-20">
                    <h2 style="color: var(--forest-green);">Family Registrations</h2>
                    <button id="btn-export-families" class="btn btn-primary btn-small">‚¨á Export CSV</button>
                </div>


                <div id="families-container">
                    <div class="spinner"></div>
                </div>
            </div>
        </div>

        <!-- Tab: Manage Activities -->
        <div class="tab-content" id="content-activities" style="display: none;">
            <div class="card">
                <div class="flex-between mb-20">
                    <h2 style="color: var(--leaf-green); margin: 0;">Manage Activities</h2>
                    <button id="btn-open-add-activity" class="btn btn-secondary btn-small">
                        ‚ûï Add Activity
                    </button>
                </div>
                <p style="color: var(--earth-brown); margin-bottom: 20px;">
                    Toggle which activities are available for parents to sign up for. Only "Available" activities will
                    be
                    shown to parents.
                </p>
                <div id="manage-activities-container">
                    <div class="spinner"></div>
                </div>
            </div>
        </div>

        <!-- Tab: Activity Sign-ups -->
        <div class="tab-content" id="content-signups" style="display: none;">
            <div class="card">
                <div class="flex-between mb-20">
                    <h2 style="color: var(--sunset-orange);">Activity Sign-ups</h2>
                    <button id="btn-export-activities" class="btn btn-primary btn-small">‚¨á Export CSV</button>
                </div>

                <div id="activities-container">
                    <div class="spinner"></div>
                </div>
            </div>
        </div>

        <!-- Tab: Payments -->
        <div class="tab-content" id="content-payments" style="display: none;">
            <div class="card">
                <div class="flex-between mb-20">
                    <h2 style="color: var(--forest-green);">Transactions</h2>
                </div>
                <p style="color: var(--earth-brown); margin-bottom: 20px;">
                    All payments are tracked at family level.
                </p>
                <div id="payments-container">
                    <div class="spinner"></div>
                </div>
            </div>
        </div>

        <!-- Tab: Backups -->
        <div class="tab-content" id="content-backups" style="display: none;">
            <div class="card">
                <div class="flex-between mb-20">
                    <h2 style="color: var(--forest-green);">Database Backups</h2>
                    <button id="btn-create-backup-tab" class="btn btn-secondary btn-small">
                        üíæ Create Backup Now
                    </button>
                </div>
                <p style="color: var(--earth-brown); margin-bottom: 20px;">
                    Backups are created automatically every day at 2:00 AM UTC. The last 30 backups are kept.
                </p>
                <div id="backups-container">
                    <div class="spinner"></div>
                </div>
            </div>
        </div>

        <!-- Add Activity Modal -->
        <div id="add-modal"
            style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center; z-index: 1000;">
            <div class="card" style="max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto;">
                <h2 style="color: var(--leaf-green); margin-bottom: 20px;">Add New Activity</h2>

                <form id="add-activity-form">
                    <div class="form-group">
                        <label>Activity Name *</label>
                        <input type="text" id="activity-name" required>
                    </div>

                    <div class="form-group">
                        <label>Session Time *</label>
                        <input type="text" id="activity-time" placeholder="e.g., Saturday 10:00 AM" required>
                    </div>

                    <div class="form-group">
                        <label>Cost (¬£)</label>
                        <input type="number" id="activity-cost" step="0.01" min="0" value="0">
                    </div>

                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="activity-description" rows="3"></textarea>
                    </div>

                    <div class="form-group">
                        <label>Max Participants</label>
                        <input type="number" id="activity-max-participants" min="0" value="0">
                        <small style="color: var(--leaf-green); display: block; margin-top: 5px;">
                            Set to 0 for unlimited participants. Activity becomes unavailable when full.
                        </small>
                    </div>

                    <div class="form-group">
                        <label>Allowed Participants *</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="add-activity-allow-child" checked>
                                <span>Children</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="add-activity-allow-adult" checked>
                                <span>Adults</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" id="btn-cancel-add" class="btn btn-secondary">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Activity</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Family Modal -->
        <div id="edit-family-modal"
            style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center; z-index: 1000; overflow-y: auto;">
            <div class="card" style="max-width: 700px; width: 90%; max-height: 90vh; overflow-y: auto; margin: 20px;">
                <h2 style="color: var(--forest-green); margin-bottom: 20px;">Edit Family Registration</h2>

                <form id="edit-family-form">
                    <input type="hidden" id="edit-family-id">
                    <input type="hidden" id="edit-family-access-key">

                    <div class="form-group">
                        <label>Booking Reference *</label>
                        <input type="text" id="edit-booking-ref" required readonly style="background: #f0f0f0;">
                    </div>

                    <div class="form-group">
                        <label>Camping Type *</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="radio" name="edit-camping-type" value="tent" required>
                                <span>‚õ∫ Tent</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="radio" name="edit-camping-type" value="campervan">
                                <span>üöê Campervan</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Which Night(s)? *</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" name="edit-nights" value="Friday">
                                <span>Friday Night</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="edit-nights" value="Saturday">
                                <span>Saturday Night</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Family Members</label>
                        <div id="edit-members-container"></div>
                        <button type="button" id="btn-edit-add-child" class="btn btn-secondary btn-small mt-20">
                            + Add Child
                        </button>
                        <button type="button" id="btn-edit-add-adult" class="btn btn-info btn-small mt-20">
                            + Add Adult
                        </button>
                    </div>

                    <div style="display: flex; gap: 10px;">
                        <button type="submit" class="btn btn-primary" style="flex: 1;">Save Changes</button>
                        <button type="button" id="btn-cancel-edit-family" class="btn btn-warning"
                            style="flex: 1;">Cancel</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Activity Modal -->
        <div id="edit-modal"
            style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center; z-index: 1000;">
            <div class="card" style="max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto;">
                <h2 style="color: var(--forest-green); margin-bottom: 20px;">Edit Activity</h2>

                <form id="edit-activity-form">
                    <input type="hidden" id="edit-activity-id">

                    <div class="form-group">
                        <label>Activity Name *</label>
                        <input type="text" id="edit-activity-name" required>
                    </div>

                    <div class="form-group">
                        <label>Session Time *</label>
                        <input type="text" id="edit-activity-time" placeholder="e.g., Saturday 10:00 AM" required>
                    </div>

                    <div class="form-group">
                        <label>Cost (¬£)</label>
                        <input type="number" id="edit-activity-cost" step="0.01" min="0" value="0">
                    </div>

                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="edit-activity-description" rows="3"></textarea>
                    </div>

                    <div class="form-group">
                        <label>Max Participants</label>
                        <input type="number" id="edit-activity-max-participants" min="0" value="0">
                        <small style="color: var(--leaf-green); display: block; margin-top: 5px;">
                            Set to 0 for unlimited participants. Activity becomes unavailable when full.
                        </small>
                    </div>

                    <div class="form-group">
                        <label>Allowed Participants *</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="edit-activity-allow-child">
                                <span>Children</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="edit-activity-allow-adult">
                                <span>Adults</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" id="btn-cancel-edit" class="btn btn-secondary">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                    </div>

                    <div style="margin-top: 15px; padding-top: 15px; border-top: 2px solid #eee;">
                        <button type="button" id="btn-delete-activity" class="btn btn-warning btn-block">
                            üóëÔ∏è Delete Activity
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Payment Modal -->
        <div id="edit-payment-modal"
            style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center; z-index: 1000;">
            <div class="card" style="max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto;">
                <h2 style="color: var(--forest-green); margin-bottom: 20px;">Edit Payment</h2>

                <form id="edit-payment-form">
                    <input type="hidden" id="edit-payment-id">

                    <div class="form-group">
                        <label>Payment Date *</label>
                        <input type="date" id="edit-payment-date" required>
                    </div>

                    <div class="form-group">
                        <label>Amount (¬£) *</label>
                        <input type="number" id="edit-payment-amount" step="0.01" min="0" required>
                    </div>

                    <div class="form-group">
                        <label>Notes</label>
                        <textarea id="edit-payment-notes" rows="3"
                            placeholder="Optional notes about this payment"></textarea>
                    </div>

                    <div style="display: flex; gap: 10px;">
                        <button type="submit" class="btn btn-primary" style="flex: 1;">Save Changes</button>
                        <button type="button" id="btn-cancel-edit-payment" class="btn btn-warning"
                            style="flex: 1;">Cancel</button>
                    </div>
                </form>
            </div>
        </div>

        <script src="common.js"></script>
        <script src="admin.js"></script>
</body>

</html>